> **Note:** This README was generated by ChatGPT.

# Using `mkcert` on Raspberry Pi to Serve HTTPS

This guide explains how to install and use **mkcert** on a Raspberry Pi to generate locally trusted HTTPS certificates. It also includes instructions to trust the generated Root Certificate Authority (CA) on **Chrome (macOS)** and **Safari (iOS)**.

---

## Overview

`mkcert` is a simple tool that creates locally trusted development certificates.

It:

- Creates a local Certificate Authority (CA)
- Installs it into the system trust store
- Uses it to generate SSL certificates for local development

This is perfect for development on a Raspberry Pi using HTTPS (for example, when hosting a local web server, dashboard, or IoT project).

---

## 1. Installing `mkcert` on Raspberry Pi

### Requirements

- Raspberry Pi running **Raspberry Pi OS** (Debian-based)
- `mkcert` available from APT repos
- `libnss3-tools`

### Step 1 — Install `mkcert` and dependencies

Run:

    sudo apt update
    sudo apt install mkcert libnss3-tools -y

### Step 2 — Create and install the local CA

Run:

    mkcert -install

You should see output like:

    The local CA is now installed in the system trust store.

`mkcert` will create:

- `rootCA.pem`
- `rootCA-key.pem`

Location (on the Pi):

    ~/.local/share/mkcert

You will need `rootCA.pem` to trust certificates on other devices (Mac, iPhone, etc.).

---

## 2. Generate HTTPS Certificates for Your Local Server

### Step 1 — Navigate to your project directory

    cd /path/to/your/project

### Step 2 — Generate certificates

Replace `myserver.local` and `192.168.1.42` with your Pi’s hostname/IP:

    mkcert myserver.local 192.168.1.42 localhost

This will output files like:

- `myserver.local+2.pem` (certificate)
- `myserver.local+2-key.pem` (private key)

### Step 3 — Use the certificates in your HTTPS server (example: Node.js / Express)

Example `server.js`:

    const fs = require('fs');
    const https = require('https');
    const express = require('express');

    const app = express();

    const options = {
      key: fs.readFileSync('./myserver.local+2-key.pem'),
      cert: fs.readFileSync('./myserver.local+2.pem'),
    };

    app.get('/', (req, res) => {
      res.send('Hello from Raspberry Pi over HTTPS!');
    });

    https.createServer(options, app).listen(443, () => {
      console.log('HTTPS server running on port 443');
    });

Then run:

    node server.js

You should now have an HTTPS server on your Raspberry Pi listening on port 443.

---

## 3. Trusting the Root CA on macOS (Chrome & Safari)

To avoid HTTPS warnings on your Mac, you must trust the `mkcert` root CA in the macOS keychain.

### Step 1 — Temporarily serve the CA from the Raspberry Pi

On the Raspberry Pi, run:

    cd $(mkcert -CAROOT)
    python3 -m http.server 8080

### Step 2 — Add the certificate to macOS Keychain

On your Mac:

1. Download the CA: http://<YOUR-DOMAIN>.local:8080/rootCA.pem
2. Open **Keychain Access** (Applications → Utilities → Keychain Access).
3. In the left sidebar, select **System** keychain (not “login”).
4. Drag `rootCA.pem` from `~/Downloads` into the **System** keychain.
5. Double-click the imported certificate (it will likely be named something like “mkcert development CA”).
6. Expand the **Trust** section.
7. Set **“When using this certificate”** to **“Always Trust”**.
8. Close the window; macOS will prompt for your password. Enter it to save the changes.
9. Restart **Chrome** and **Safari**.

### Browsers affected

- **Chrome (macOS)** — uses the macOS system trust store
- **Safari (macOS)** — uses the same trust store

After this, both browsers should trust certificates issued by your Raspberry Pi’s `mkcert` CA.

---

## 4. Trusting the Root CA on iOS (Safari)

iOS requires installing the CA as a profile and then explicitly enabling trust.

### Step 1 — Install the downloaded profile

On your iOS device:
1. On Your iPhone go to: http://<YOUR-DOMAIN>.local:8080/rootCA.pem
1. iOS will prompt to allow downloading a configuration profile. Tap **Allow**.
2. Open **Settings**.
3. You should see **Profile Downloaded** near the top. If not, go to:

   Settings → General → VPN & Device Management

4. Tap the downloaded profile (it will reference the mkcert root CA).
5. Tap **Install** in the top right.
6. Enter your passcode if prompted.
7. Tap **Install** again to confirm.

### Step 2 — Trust the root certificate

This step is required for iOS to fully trust the CA for SSL:

1. Open:

   Settings → General → About → Certificate Trust Settings

2. Under **“Enable Full Trust For Root Certificates”**, look for the mkcert root CA you just installed.
3. Toggle it **ON**.
4. Confirm when asked.

After this, **Safari on iOS** will trust certificates issued by the mkcert CA running on your Raspberry Pi.

---
